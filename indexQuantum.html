<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Path2life | Emergency Decision Support</title>

<style>
  * {
    box-sizing: border-box;
  }
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, sans-serif;
    background: linear-gradient(120deg, #eaf2ff, #f9fbff);
    min-height: 100vh;
  }
  header {
    background: linear-gradient(90deg, #0a6cf1, #14b8a6);
    color: white;
    padding: 35px 15px;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  }
  header h1 {
    margin: 0;
    font-size: 38px;
    font-weight: bold;
  }
  header p {
    margin-top: 10px;
    opacity: 0.95;
    font-size: 16px;
  }
  .quantum-badge {
    display: inline-block;
    background: rgba(255,255,255,0.2);
    padding: 5px 15px;
    border-radius: 20px;
    font-size: 13px;
    margin-top: 10px;
    backdrop-filter: blur(10px);
  }
  .container {
    max-width: 950px;
    margin: -40px auto 40px;
    background: white;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.15);
  }
  .section-title {
    font-size: 22px;
    margin-bottom: 25px;
    color: #0a6cf1;
    border-left: 5px solid #14b8a6;
    padding-left: 15px;
    font-weight: bold;
  }
  .input-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 25px;
  }
  .input-field {
    display: flex;
    flex-direction: column;
  }
  label {
    font-weight: 600;
    color: #333;
    margin-bottom: 8px;
    font-size: 14px;
  }
  input, select {
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    border: 2px solid #e0e0e0;
    font-size: 15px;
    transition: border-color 0.3s;
  }
  input:focus, select:focus {
    outline: none;
    border-color: #0a6cf1;
  }
  .radio-group {
    display: flex;
    gap: 30px;
    margin: 10px 0 20px;
  }
  .radio-group label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
  }
  .checkbox {
    margin: 20px 0;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .checkbox input {
    width: auto;
    cursor: pointer;
  }
  .checkbox label {
    margin: 0;
    cursor: pointer;
  }
  .button-group {
    display: flex;
    gap: 15px;
    margin-top: 30px;
    flex-wrap: wrap;
  }
  .primary-btn {
    flex: 2;
    background: linear-gradient(90deg, #0a6cf1, #14b8a6);
    color: white;
    padding: 16px;
    border: none;
    border-radius: 12px;
    font-size: 17px;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.3s, box-shadow 0.3s;
    min-width: 200px;
  }
  .primary-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(10,108,241,0.3);
  }
  .secondary-btn {
    flex: 1;
    background: #e6efff;
    color: #0a6cf1;
    padding: 16px;
    border-radius: 12px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    text-align: center;
    transition: background 0.3s;
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
  }
  .secondary-btn:hover {
    background: #d9e6ff;
  }
  .result {
    margin-top: 35px;
    padding: 30px;
    background: linear-gradient(135deg, #f0f6ff 0%, #e6efff 100%);
    border-radius: 15px;
    display: none;
    border-left: 5px solid #0a6cf1;
  }
  .result h3 {
    color: #0a6cf1;
    margin-bottom: 20px;
    font-size: 22px;
  }
  .result-item {
    background: white;
    padding: 15px;
    margin: 12px 0;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  }
  .result-item strong {
    color: #333;
    display: block;
    margin-bottom: 5px;
  }
  .chatbot-btn {
    margin-top: 20px;
    background: linear-gradient(90deg, #8b5cf6, #6366f1);
    color: white;
    padding: 14px 28px;
    border: none;
    border-radius: 12px;
    font-weight: bold;
    cursor: pointer;
    display: none;
    transition: transform 0.3s, box-shadow 0.3s;
  }
  .chatbot-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(139,92,246,0.3);
  }
  .info-box {
    background: linear-gradient(135deg, #fff5e6 0%, #ffe6cc 100%);
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 30px;
    border-left: 5px solid #ff9800;
  }
  .info-box p {
    margin: 0;
    color: #666;
    font-size: 14px;
  }
  footer {
    text-align: center;
    margin-top: 40px;
    padding: 20px;
    color: #666;
    font-size: 14px;
  }
  @media (max-width: 768px) {
    .input-grid {
      grid-template-columns: 1fr;
    }
    .button-group {
      flex-direction: column;
    }
    header h1 {
      font-size: 28px;
    }
  }
</style>
</head>

<body>

<header>
  <h1>üöë Path2life</h1>
  <p>Smart Emergency Decision Support System for Palestine</p>
  <div class="quantum-badge">‚öõÔ∏è Powered by Quantum-Inspired AI</div>
</header>

<div class="container">

  <div class="info-box">
    <p>
      üí° <strong>New:</strong> Path2life now uses quantum-inspired optimization algorithms 
      to find the best ambulance and route in under 100ms for critical emergencies.
    </p>
  </div>

  <div class="section-title">üìã Emergency Case Input</div>

  <div class="input-grid">
    <div class="input-field">
      <label>Age</label>
      <input type="number" id="age" placeholder="Enter patient age" min="0" max="120" required />
    </div>

    <div class="input-field">
      <label>Gender</label>
      <select id="gender">
        <option>Male</option>
        <option>Female</option>
      </select>
    </div>

    <div class="input-field">
      <label>Chronic Diseases</label>
      <select id="chronic">
        <option>None</option>
        <option>Diabetes</option>
        <option>Heart Disease</option>
        <option>Asthma</option>
      </select>
    </div>

    <div class="input-field">
      <label>City</label>
      <select id="city">
        <option>Ramallah</option>
        <option>Nablus</option>
        <option>Hebron</option>
        <option>Jenin</option>
        <option>Bethlehem</option>
        <option>Jericho</option>
        <option>Tulkarm</option>
        <option>Qalqilya</option>
      </select>
    </div>
  </div>

  <label>Incident Type</label>
  <div class="radio-group">
    <label>
      <input type="radio" name="incident" value="medical" checked />
      üè• Medical Emergency
    </label>
    <label>
      <input type="radio" name="incident" value="traffic_accident" />
      üöó Traffic Accident
    </label>
  </div>

  <label>Symptoms / Incident Details</label>
  <input type="text" id="symptoms" placeholder="e.g., chest pain, bleeding, difficulty breathing" />

  <div class="checkbox">
    <input type="checkbox" id="closedRoad" />
    <label>üöß Road Closed or Major Traffic</label>
  </div>

  <div class="button-group">
    <button id="analyzeBtn" class="primary-btn">üîç Analyze Emergency Case</button>
    <button type="button" onclick="resetForm()" class="secondary-btn">üîÑ Reset</button>
    <a href="aboutQuantum.html" class="secondary-btn">‚ÑπÔ∏è About</a>
  </div>

  <div class="result" id="resultBox"></div>

</div>

<footer>
  ¬© 2026 Path2life ‚Äì Emergency AI Support for Palestine üáµüá∏
</footer>

<script>
  document.getElementById("analyzeBtn").addEventListener("click", async () => {
    const age = document.getElementById("age").value;
    const gender = document.getElementById("gender").value.toLowerCase();
    const chronic = document.getElementById("chronic").value.toLowerCase();
    const symptoms = document.getElementById("symptoms").value;
    const city = document.getElementById("city").value;
    const closedRoad = document.getElementById("closedRoad").checked ? "Yes" : "No";
    const incidentType = document.querySelector('input[name="incident"]:checked').value;

    if (!age) {
      alert("‚ö†Ô∏è Please enter patient age");
      return;
    }

    if (!symptoms.trim()) {
      alert("‚ö†Ô∏è Please enter symptoms or incident details");
      return;
    }

    // ÿπÿØŸÑŸä ÿßŸÑÿ±ÿßÿ®ÿ∑ ÿ≠ÿ≥ÿ® ÿßÿ≥ÿ™ÿ∂ÿßŸÅÿ© ÿ®ÿßŸÉŸÜÿØŸÉ (ŸÖÿ´ŸÑÿß http://localhost:5000 ÿ£Ÿà ÿ±ÿßÿ®ÿ∑ ÿßŸÑÿ±ŸäŸÖŸàÿ™)
    const apiURL = `http://127.0.0.1:5000/decision?age=${age}&gender=${gender}&chronic_diseases=${chronic}&symptoms=${encodeURIComponent(symptoms)}&incident_type=${incidentType}&location=${city}&closed_roads=${closedRoad}`;

    const resultBox = document.getElementById("resultBox");
    resultBox.style.display = "block";
    resultBox.innerHTML = `
      <div style="text-align: center; padding: 20px;">
        <div style="font-size: 40px; margin-bottom: 10px;">‚è≥</div>
        <p style="color: #666;">Analyzing emergency case using quantum optimization...</p>
        <p style="font-size: 13px; color: #999;">This typically takes less than 100ms</p>
      </div>
    `;

    try {
      const startTime = Date.now();
      const response = await fetch(apiURL);
      const data = await response.json();
      const endTime = Date.now();
      const processingTime = endTime - startTime;

      // ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ±ÿØ ŸÅŸä ÿßŸÑŸÉŸàŸÜÿ≥ŸàŸÑ ŸÑŸà ÿ≠ÿ®Ÿäÿ™
      console.log("API Response:", data);

      // ÿπÿ±ÿ∂ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨
      const riskLevel = data.risk_assessment?.risk_level || (
        data.risk_score >= 0.75 ? "Critical" : 
        data.risk_score >= 0.5 ? "High" : 
        data.risk_score >= 0.3 ? "Medium" : "Low"
      );

      const riskColor = 
        riskLevel === "Critical" ? "#e63946" : 
        riskLevel === "High" ? "#ff9800" : 
        riskLevel === "Medium" ? "#ffc107" : "#4caf50";

      resultBox.innerHTML = `
        <h3>üöë Emergency Decision Result</h3>

        <div class="result-item">
          <strong>‚ö†Ô∏è Risk Assessment</strong>
          <div style="display: flex; align-items: center; gap: 10px; margin-top: 8px;">
            <span style="font-size: 24px; font-weight: bold; color: ${riskColor};">
              ${data.risk_assessment?.risk_score ?? data.risk_score ?? "N/A"}
            </span>
            <span style="background: ${riskColor}; color: white; padding: 4px 12px; border-radius: 20px; font-size: 13px;">
              ${riskLevel}
            </span>
          </div>
        </div>

        

        <div class="result-item">
          <strong>üöë Selected Ambulance</strong>
          <p style="color: #666; margin: 5px 0 0 0;">
            ${data.ambulance ? data.ambulance.name : 'Unknown Ambulance'}
          </p>
          ${data.ambulance?.equipment ? `
          <p style="font-size: 13px; color: #999; margin-top: 5px;">
            Equipment: ${data.ambulance.equipment.join(', ')}
          </p>
          ` : ''}
        </div>

        ${data.route ? `
          <div class="result-item">
            <strong>üó∫Ô∏è Optimal Route</strong>
            <p style="color: #666; margin: 5px 0 0 0;">
              Selected Route: <strong>${data.route.name}</strong> (ID: ${data.route.id})
            </p>
            <p style="font-size: 13px; color: #999; margin-top: 5px;">
              Distance: ${data.route.distance_km} km | Estimated Time: ${data.route.eta_minutes} minutes | Route Risk: ${typeof data.route.risk_level === 'number' ? (data.route.risk_level * 100).toFixed(1) + '%' : 'N/A'}
            </p>
          </div>
        ` : `
          <div class="result-item">
            <strong>‚è±Ô∏è Estimated Arrival Time</strong>
            <p style="color: #666; margin: 5px 0 0 0;">${data.estimated_time ?? 'N/A'} minutes</p>
          </div>
        `}

        <div class="result-item">
          <strong>üìù Decision Explanation</strong>
          <p style="color: #666; margin: 5px 0 0 0; line-height: 1.6;">
            ${data.decision?.reason || data.decision_reason || 'No explanation provided.'}
          </p>
        </div>

        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin-top: 15px;">
          <p style="color: #2e7d32; font-size: 14px; margin: 0;">
            ‚úÖ <strong>Recommendation:</strong> ${data.decision?.recommendation || 
            `Dispatch ${data.ambulance ? data.ambulance.id : 'Unknown'} immediately`}
          </p>
        </div>

        <p style="color: #999; font-size: 12px; margin-top: 15px; text-align: center;">
          ‚ö° Processed in ${processingTime}ms | Analysis timestamp: ${new Date().toLocaleString()}
        </p>
      `;
    } catch (error) {
      console.error("API Error:", error);
      resultBox.innerHTML = `
        <div style="text-align: center; padding: 20px;">
          <div style="font-size: 40px; margin-bottom: 10px;">‚ùå</div>
          <p style="color: #e63946; font-weight: bold;">Unable to connect to backend server</p>
          <p style="color: #666; font-size: 14px; margin-top: 10px;">
            Please check your internet connection and try again.
          </p>
        </div>
      `;
    }
  });

  function resetForm() {
    document.querySelectorAll("input[type='text'], input[type='number']").forEach(i => i.value = "");
    document.querySelectorAll("select").forEach(s => s.selectedIndex = 0);
    document.querySelector("input[type='radio'][value='medical']").checked = true;
    document.getElementById("closedRoad").checked = false;
    document.getElementById("resultBox").style.display = "none";
  }
</script>

</body>
</html>
